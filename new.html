<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8"/>
    <title>Kendo UI Snippet</title>

    <link rel="stylesheet" href="https://kendo.cdn.telerik.com/2021.2.616/styles/kendo.default-v2.min.css"/>

    <script src="https://code.jquery.com/jquery-1.12.4.min.js"></script>
    <script src="https://kendo.cdn.telerik.com/2021.2.616/js/kendo.all.min.js"></script>
</head>
<body>

<style>
    .area{
        width: 80vh;
        height:50vh;
     
        border: 1px solid #e0aeae;
       
        padding: 3px;
    
    }
</style>  
<div id="gameArea" class ="area">

</div>
<div id="dialog"></div>
<button id="Right">Right</button>
<div id="grid"></div>
<div id="newGrid"></div>
<div id="table"></div>
<div id="gameGrid"></div>

<script>

var leftCode=37;
var upCode=38;
var rightCode=39;
var downCode=40;
var i=0;
var beginValue=2;
var arrOfCoords=[
[]

];

var row={
    first:0,
    second:0,
    third:0,
    fourth:0,
  //  fifth:0
}
var table=row[4];
var jsonData="";
var startData= init(table);
var coordsValues=[
   [2,"","",""],
   ["","","",""],
   ["","","",""],
   ["","","",""]
];
var dataByRow=[
    {
        "first":"2",
        "second":"",
        "third":"2",
        "fourth":""
    },
    {
        "first":"",
        "second":"",
        "third":"",
        "fourth":""
    },
    {
        "first":"",
        "second":"",
        "third":"",
        "fourth":""
    },
    {
        "first":"",
        "second":"",
        "third":"",
        "fourth":""
    }
   
]
var tempVar= arrObjInit(dataByRow);
console.log(tempVar);
$(document).ready(function() {
    var res=seedAtRandomPos(coordsValues);
    alert(res);
    console.log(seedAtRandomPos(coordsValues));
$(this).keydown(function(e)
{
    console.log(e.keyCode);
    switch(e.keyCode)
   {
    
       case rightCode:
          // tryMoveRight(coordsValues);
           $("#dialog").kendoWindow({

            position: {
             top: currentTop, 
             left:"90%"
            } 
           });
         alert(  seedAtRandomPos(coordsValues));
           break;
           case leftCode:
           $("#dialog").kendoWindow({
            position: {
             top: currentTop, 
             left:"1%"
            } 
           });
               break;
               case upCode:
               $("#dialog").kendoWindow({
            position: {
             top: "0%", 
             left:currentLeft
            } 
           });
           break;
           case downCode:
           $("#dialog").kendoWindow({
            position: {
             top: "85%", 
             left:currentLeft
            } 
           });
           break;

   }

});
  
    var win = $("#dialog").data("kendoWindow");
var position = win.wrapper.offset();
var currentTop=position.top;
var currentLeft=position.left;
console.log(currentTop);
console.log(currentLeft);
   // console.log(e.keyCode);
  
                    $("#gameGrid").kendoGrid({
             				 dataSource: {
                     data: coordsValues
                    
                },
                height: 500,
                columns: [
                  { field:"[0]", title: " " },
                  { field: "[1]", title:" " },
                  { field: "[2]", title:" "},
                  { field: "[3]",title:" "},
                  {
                    groupable: true ,
                  //  template:"#for(var i=0;i<)"
                    //template: ""
                  },
                  {  hidden: true,  field: "location",title:"Location"},
                  { command: ["edit", "destroy"], title: "&nbsp;", width: "250px" }],
                      editable: "popup",
                groupable: true,
                sortable: true,
                batch: true,

                selectable: "multiple",
                filterable: true,
                reorderable: true,
                resizable: true,
                EnableAlternatingRowColor: true,
                pageable: {
                    refresh: true,
                    pageSizes: true,
                    buttonCount: 5


   }
                    });
                });
var rowData=[];
for(var i=0; i<coordsValues.length;i++)
{
    rowData.push({
        first:coordsValues[i][0],
        second:coordsValues[i][1],
        third:coordsValues[i][2],
        fourth:coordsValues[i][3]

    });

}

//var tempDataSource=kendo.data.DataSource({data:coordsValues});
var jsonData=JSON.stringify(coordsValues);
console.log(jsonData);
//var data=JSON.parse(jsonData, arrOfCoords);
//console.log(data);
var gameMatrix=initArr(coordsValues);
console.log(gameMatrix);
var temp=kendo.template("<div id='box'><span>#=value#</span></div> ");
var data={value:`<b>${beginValue}</b>`};
var res=temp(data);
$("#grid").kendoGrid({

    columns: [ {
    //field: "fld",
   // template: "#<div id='box'><span>#=name#</span></div> "
  }],
  //dataSource: tempDataSource
});
$("#dialog").kendoWindow({
  
});
$("#table").kendoGrid({
columns:[],
dataSource:[]
});


$("#dialog").html(res);
console.log(($('#dialog').data("kendoWindow").wrapper.offset()));
$("#newGrid").kendoGrid({
    rowTemplate: '<div id=`box`>#: name #</div>',
    dataSource:[coordsValues.toString()]
        
});

    
$('#gameDiv').keydown(function(e){
var win = $("#dialog").data("kendoWindow");
var position = win.wrapper.offset();
var leftPos=position.left;
console.log($('#dialog').data("kendoWindow").wrapper.offset());
    if(e.keyCode==rightCode)
    {
            $('#dialog').kendoWindow({
                position: {
             top: 100, 
             left:(leftPos+150)
            } 
            });
    }

});
$("#Right").click(function(){
    $('#dialog').kendoWindow({
                position: {
             top: "1%", // or "100px"
             left:"100%"
            } 
            });
});


   
function init(r)
{
    if(r!==undefined)
    {
        r[0].first=2;
    }
    return r;
}
function initArr(a)
{
    if(a!==undefined)
    {
        a[0][0]=2;
    }
    return a;
    
}
$(document).ready().keydown(function(e){
   console.log(e.keyCode);

    var win = $("#dialog").data("kendoWindow");
var position = win.wrapper.offset();
var currentTop=position.top;
var currentLeft=position.left;
console.log(currentTop);
console.log(currentLeft);
   // console.log(e.keyCode);
   switch(e.keyCode)
   {
    
       case rightCode:
          tryMoveRight(coordsValues);
           $("#dialog").kendoWindow({

            position: {
             top: currentTop, 
             left:"90%"
            } 
           });
           break;
           case leftCode:
           $("#dialog").kendoWindow({
            position: {
             top: currentTop, 
             left:"1%"
            } 
           });
               break;
               case upCode:
               $("#dialog").kendoWindow({
            position: {
             top: "0%", 
             left:currentLeft
            } 
           });
           break;
           case downCode:
           $("#dialog").kendoWindow({
            position: {
             top: "85%", 
             left:currentLeft
            } 
           });
           break;

   }

});

function arrObjInit(obj)
{
    if(obj!==undefined)
    {
        var indexes=[];
        var data=obj.filter(a=>(a.first=="")|| (a.second=="")|| (a.third=="") || (a.fourth==""));
            return data;
    }
}
function tryMoveRight(arr)
{
    if(arr!==undefined)
    {
        var changes=[
            [],
            [],
            [],
            []
        ]
        for(var i=0; i<arr.length;i++)
        {
            
         for(var j=1;j<arr[i].length;j++)
         {

             if(arr[i][j]==arr[i][j-1])
             {
                var temp=(arr[i][j])*2;
                changes[i].push(temp);

             }
             else{
                 changes[i].push(arr[i][j]);
             }
             

         }
       /*  for(var i=0;i<changes.length;i++)
         {
           if(changes[i].length<arr[i].length)
           {
               while(changes[i].length!=arr[i].length)
               {
                   changes[i].unshift("");
               }
           }
         }*/

        }
        for(var i=0; i<arr.length;i++)
        {
            for(var j=arr[i].length-1;j>=0;j--)
            {
                if(arr[i][j]==0)
                {
                    for(var c=changes[i].length-1; c>=0;c--)

                    {

                        arr[i][j]=changes[i][c];
                    }
                }
            }
        }
    }
}
function seedAtRandomPos(arr)

{
    var coordsPossible=[[]];
    var curCoord=[];
    for(var i=0; i<arr.length;i++)
    {
        for(var j=0;j<arr[i].length;j++)
        {
            if(arr[i][j]=="")
            {
                curCoord.push(i);
                curCoord.push(j);
                coordsPossible.push(curCoord);
            }
        }
    }
  var coord=  Math.floor(Math.random() * coordsPossible.length);
  console.log(coord);

  var tmp=coordsPossible[coord];
  console.log(tmp);
  var _i=tmp[0];
  var _j=tmp[1];
  for(var i=0; i<arr.length;i++)
  {
      for(var j=0;j<arr[i].length;j++)
      {
          if(i==_i && j==_j)
          {
              arr[i][j]=2;
          }
      }
  }
  return arr;
}
function moveDown(arr)
{
    if(arr!=null && arr!==undefined)
    {
        var firstColumnStepsToDown=0;
        var secondColumnStepsToDown=0;
        var thirdColumnStepsToDown=0;
        var fourthColumnStepsToDown=0;
        var columnsStepsArr=[0,0,0,0];
        
        for(var i=1; i<arr.length;)
        {
            for(var j=0;j<arr[i].length;j++)
            {
                if(arr[i][j]==arr[i-1][j])
                {
                    arr[i][j]=(arr[i][j]+arr[i-1][j]);
                    arr[i-1][j]="";
                }

            }
        }

        for(var i=arr.length-1;i>0;i--)
        {
            for(var j=0;j<arr[i].length;j++)
            {
                if(arr[i][j]=="" && arr[i-1][j]
                )
                {
                    arr[i][j]=arr[i-1][j];
                    arr[i-1][j]="";
                }
            }
        }

        for(var i=arr.length-1; i>0;i--)
        {
            for(var j=0;j<arr[i].length;j++)
            {
                if(arr[i][j]=="")
                {
                    columnsStepsArr[j]++;
                    continue;
                }

              //  if(arr[i-1][j]==arr[i][j])
             //   {
              //      columnsStepsArr[j]++;
             //       continue;
             //   }

            }
        }

    }

}
function moveUp()
{

}
function moveLeft()
{

}
function moveRight()
{

}
</script>
</body>
</html>